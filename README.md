## Телеграм бот [Kinobot](https://t.me/shminobot) ![Telegram](https://upload.wikimedia.org/wikipedia/commons/thumb/8/82/Telegram_logo.svg/20px-Telegram_logo.svg.png)

[![Go Report Card](https://goreportcard.com/badge/github.com/luzhnov-aleksei/kinobot)](https://goreportcard.com/report/github.com/luzhnov-aleksei/kinobot)

### Описание
Бот, который позволяет пользователям искать информацию о фильмах. Бот получает запросы от пользователей, отправляет их на внешний Kinopoisk API для получения данных о фильмах и возвращает пользователю информацию в виде текстового сообщения с кратким описанием фильма и изображением постера. Бот также ограничивает количество сообщений, которые пользователь может отправить за день, для предотвращения спама, и удаляет запросы пользователя после их получения, для чистоты диалога. Тем самым можно использовать бота как заметки с фильмами.

### 1. Аутентификация и ключи
- Используется API-ключ для подключения к Telegram через переменную окружения `BOT_KEY`.
- Используется API-ключ для получения данных о фильмах через переменную окружения `API_KEY`.

### 2. Функционал
- Обработка команды `/start` для приветствия пользователя и предоставления инструкций.
- Обработка команды `/help` для предоставления инструкций.
- Обработка текстовых сообщений от пользователя, отправка запроса к внешнему API для получения данных о фильме.
- Удаление старых сообщений от пользователя для сохранения "чистоты" диалога.
- Ограничение на количество сообщений в день, которые может отправить пользователь (максимум 20 сообщений за 24 часа).

### 3. Компоненты
##### API взаимодействие
- Запросы к внешнему API для получения данных о фильмах.
- Ответ содержит информацию о типе фильма (фильм, сериал, мультфильм и т.д.), его названии, году выпуска, жанре, рейтингах (IMDb, КП), возрастных ограничениях, стране производства, длительности и описании.
- Отправка пользователю постера фильма и ссылки на фильм на Kinopoisk.
- Обработка ошибок, таких как отсутствие данных о фильме или превышение лимита запросов к API.

##### Ограничение запросов (limiter)
- Каждый пользователь может отправить до 20 сообщений за 24 часа.
- Общий лимит от Kinopoisk API - 200 бесплатных запросов в день.

### 4. Сообщения
- Информирование пользователя о превышении лимита запросов с соответствующим предупреждением.
- В случае ошибки при получении данных от API — отправка сообщения об ошибке пользователю.

### 5. Ограничения и обработка ошибок
- Если лимит API на день исчерпан, бот уведомляет пользователя о необходимости вернуться на следующий день.
- Если фильм не найден или произошла ошибка с API, бот должен отправить соответствующее сообщение об ошибке.

### 6. Тестирование
- Написание юнит-тестов для проверки логики обработки запросов и лимита сообщений.
- Тестирование взаимодействия с API (в том числе проверка корректности ответа и обработки ошибок).
- Тестирование ограничения на количество сообщений от пользователя.

### 7. Упаковка и развертывание
- Проект упакован в Docker-контейнер.
- Для развертывания используется `docker-compose`.
- Dockerfile включает сборку и запуск бота.

## Итог
- Реализован алгоритм обработки запросов и получения данных от API.
- Реализовано разделение на слои (API взаимодействие, обработка запросов, ограничение на количество сообщений).
- Реализовано API взаимодействие с внешним сервисом (получение данных о фильмах).
- Реализован интерфейс для взаимодействия с пользователем через Telegram.
- Написаны юнит-тесты.
- Написаны интеграционные тесты для проверки взаимодействия с API.